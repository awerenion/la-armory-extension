import{c as v,o,a as c,b as n,n as q,u as f,F as _,d as m,e as L,t as p,r as S,f as x,p as A,g as C,h as k}from"./runtime-dom.esm-bundler.15a124d3.js";const $={loadAtStart:!0,modifyEngravings:!0,displayQuality:!0},T={0:"black",25:"rgb(219, 192, 0)",50:"rgb(0, 183, 0)",70:"rgb(0, 84, 255)",90:"rgb(255, 0, 221)",100:"rgb(255, 94, 0)"};var b=(t,e)=>{const a=t.__vccOpts||t;for(const[r,s]of e)a[r]=s;return a};const N=["src"],B={class:"bar"},w={__name:"QualityBar",props:{quality:Number,url:String},setup(t){const e=t,a=v(()=>({backgroundColor:function(){let r;switch(!0){case e.quality===0:r=0;break;case e.quality<39:r=25;break;case e.quality<70:r=50;break;case e.quality<90:r=70;break;case e.quality<100:r=90;break;case e.quality===100:r=100;break}return T[r]}(),width:e.quality!==0?e.quality+"%":"100%"}));return(r,s)=>(o(),c(_,null,[n("img",{src:e.url,alt:""},null,8,N),n("div",B,[n("div",{class:"quality",style:q(f(a))},null,4)])],64))}};var I=b(w,[["__scopeId","data-v-2347e6ad"]]);function Q(){let t={};const e=document.querySelectorAll(".profile-equipment__slot>div");t=JSON.parse(document.querySelector("#profile-ability > script").innerText.replace(/.+\{/,"[{").replace(/;\n$/,"]")),e.forEach(a=>{if(a.classList.length===1&&parseInt(a.className.replace(/slot(\d+)$/,"$1"))<=11){let r=a.getAttribute("data-item"),s=parseInt(t[0].Equip[r].Element_001.value.qualityValue);a.style.flexWrap="wrap",m(I,{quality:s,url:a.firstElementChild.getAttribute("src")}).mount(a)}})}const O=["\u0418\u0437\u043D\u043E\u0441","\u0420\u0436\u0430\u0432\u0447\u0438\u043D\u0430","\u041C\u0435\u0434\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C","\u041C\u0438\u0440\u043E\u043B\u044E\u0431\u0438\u0435"];const V={style:{"justify-content":"space-between"}},G={class:"profile-ability-tooltip"},F={__name:"Engraving",props:{name:String,level:Number,tooltipText:String},setup(t){const e=t,a=v(()=>O.includes(e.name));return(r,s)=>(o(),c(_,null,[n("div",V,[n("span",{class:L({"negative-engraving":f(a)})},p(e.name),3),n("span",null,p(e.level)+" \u0443\u0440. ",1)]),n("div",G,[n("p",null,p(e.tooltipText),1)])],64))}};var M=b(F,[["__scopeId","data-v-bd1b683e"]]);const D=t=>(A("data-v-26ca8908"),t=t(),C(),t),R=D(()=>n("h4",null,"\u0413\u0440\u0430\u0432\u0438\u0440\u043E\u0432\u043A\u0438",-1)),j={class:"swiper-container"},z={class:"swiper-wrapper"},H={class:"swiper-slide"},J={class:"swiper-slide-item"},P={__name:"EngravingList",props:{engravingList:Array},setup(t){return(e,a)=>(o(),c(_,null,[R,n("div",j,[n("div",z,[n("ul",H,[(o(!0),c(_,null,S(t.engravingList,r=>(o(),c("li",J,[x(M,{name:r.name,level:r.level,"tooltip-text":r.tooltipText},null,8,["name","level","tooltip-text"])]))),256))])])])],64))}};var U=b(P,[["__scopeId","data-v-26ca8908"]]);function W(){const t=document.querySelector(".profile-ability-engrave");t.style.height="auto";const e=document.querySelectorAll(".swiper-slide>li"),a=[];e.length>0&&e.forEach(r=>{let s=JSON.parse(r.firstElementChild.innerHTML.replace(/(.+)\s(\d) ур\./g,'{"name":"$1", "level":$2}'));s.tooltipText=r.lastElementChild.firstElementChild.innerText,a.push(s)}),m(U,{engravingList:a}).mount(t)}let h={};function K(t){chrome.runtime.sendMessage({type:"load-for-class",message:[...new Set(t.map(e=>e.class))]},e=>{h=e,t.forEach(a=>{let r=X(a.class,a.name);r&&r>0&&(a.element.innerHTML=a.name+"("+r+")")})})}function X(t,e){var a;return h[t]?(a=h[t].find(r=>r.nickname===e))==null?void 0:a.rating:0}const Y=["onClick"],Z=["src","alt"],ee={__name:"CharacterList",props:{characterList:Array},setup(t){const e=t,a=s=>{location.href=`/Profile/Character/${s}`},r=v(()=>e.characterList.sort((s,u)=>+s.gs<+u.gs?1:+s.gs>+u.gs?-1:0));return(s,u)=>(o(!0),c(_,null,S(f(r),(l,i)=>(o(),c("li",{key:i+"ch"},[n("span",null,[n("button",{type:"button",onClick:y=>a(l.name)},[n("img",{src:l.img,alt:l.characterClass},null,8,Z),k(" \u0423\u0440."+p(l.level)+" ",1),n("span",null,p(l.name)+"("+p(l.gs)+")",1)],8,Y)])]))),128))}};function E(t){const e={};t.forEach(a=>{chrome.runtime.sendMessage({type:"load-character-info",name:a.name},r=>{e[a.name]=r.gs})}),setTimeout(()=>{const a=[];document.querySelectorAll("#expand-character-list > ul").forEach((s,u)=>{a.push([]),Array.from(s.children).forEach(l=>{const i={},y=l.querySelector("button span").textContent;i.name=y,i.gs=e[y],i.class=l.querySelector("button img").getAttribute("alt"),i.img=l.querySelector("button img").getAttribute("src"),i.level=60,a[u].push(i)}),m(ee,{characterList:a[u]}).mount(s)})},t.length*250)}const te={__name:"RefreshButton",props:{characterList:Array},setup(t){const e=t;function a(){E(e.characterList)}return(r,s)=>(o(),c("button",{onClick:a},"\u21BB"))}};let g={},d=[];async function ae(){await chrome.storage.sync.get().then(t=>{Object.assign(g,$,t)})}try{document.querySelectorAll("#expand-character-list > ul > li").forEach(e=>{d.push({element:e.querySelector("span > button > span"),name:e.querySelector("button span").textContent,class:e.querySelector("button img").getAttribute("alt")})});const t=document.createElement("div");document.getElementById("expand-character-list").prepend(t),m(te,{characterList:d}).mount(t),ae().then(()=>{g.loadAtStart?E(d):K(d),g.displayQuality&&Q(),g.modifyEngravings&&W()})}catch(t){console.error(t)}
