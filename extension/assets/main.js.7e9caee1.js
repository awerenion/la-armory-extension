import{c as h,o as i,a as o,b as n,n as q,u as v,F as _,d as m,e as L,t as u,r as S,f as x,p as A,g as C,h as k}from"./runtime-dom.esm-bundler.15a124d3.js";const N={loadAtStart:!0,modifyEngravings:!0,displayQuality:!0},T={0:"black",25:"rgb(219, 192, 0)",50:"rgb(0, 183, 0)",70:"rgb(0, 84, 255)",90:"rgb(255, 0, 221)",100:"rgb(255, 94, 0)"};var f=(e,t)=>{const a=e.__vccOpts||e;for(const[r,s]of t)a[r]=s;return a};const $=["src"],B={class:"bar"},w={__name:"QualityBar",props:{quality:Number,url:String},setup(e){const t=e,a=h(()=>({backgroundColor:function(){let r;switch(!0){case t.quality===0:r=0;break;case t.quality<39:r=25;break;case t.quality<70:r=50;break;case t.quality<90:r=70;break;case t.quality<100:r=90;break;case t.quality===100:r=100;break}return T[r]}(),width:t.quality!==0?t.quality+"%":"100%"}));return(r,s)=>(i(),o(_,null,[n("img",{src:t.url,alt:""},null,8,$),n("div",B,[n("div",{class:"quality",style:q(v(a))},null,4)])],64))}};var I=f(w,[["__scopeId","data-v-2347e6ad"]]);function Q(){let e={};const t=document.querySelectorAll(".profile-equipment__slot>div");e=JSON.parse(document.querySelector("#profile-ability > script").innerText.replace(/.+\{/,"[{").replace(/;\n$/,"]")),t.forEach(a=>{if(a.classList.length===1&&parseInt(a.className.replace(/slot(\d+)$/,"$1"))<=11){let r=a.getAttribute("data-item"),s=parseInt(e[0].Equip[r].Element_001.value.qualityValue);a.style.flexWrap="wrap",m(I,{quality:s,url:a.firstElementChild.getAttribute("src")}).mount(a)}})}const O=["\u0418\u0437\u043D\u043E\u0441","\u0420\u0436\u0430\u0432\u0447\u0438\u043D\u0430","\u041C\u0435\u0434\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C","\u041C\u0438\u0440\u043E\u043B\u044E\u0431\u0438\u0435"];const V={style:{"justify-content":"space-between"}},G={class:"profile-ability-tooltip"},F={__name:"Engraving",props:{name:String,level:Number,tooltipText:String},setup(e){const t=e,a=h(()=>O.includes(t.name));return(r,s)=>(i(),o(_,null,[n("div",V,[n("span",{class:L({"negative-engraving":v(a)})},u(t.name),3),n("span",null,u(t.level)+" \u0443\u0440. ",1)]),n("div",G,[n("p",null,u(t.tooltipText),1)])],64))}};var M=f(F,[["__scopeId","data-v-bd1b683e"]]);const D=e=>(A("data-v-26ca8908"),e=e(),C(),e),R=D(()=>n("h4",null,"\u0413\u0440\u0430\u0432\u0438\u0440\u043E\u0432\u043A\u0438",-1)),j={class:"swiper-container"},z={class:"swiper-wrapper"},H={class:"swiper-slide"},J={class:"swiper-slide-item"},U={__name:"EngravingList",props:{engravingList:Array},setup(e){return(t,a)=>(i(),o(_,null,[R,n("div",j,[n("div",z,[n("ul",H,[(i(!0),o(_,null,S(e.engravingList,r=>(i(),o("li",J,[x(M,{name:r.name,level:r.level,"tooltip-text":r.tooltipText},null,8,["name","level","tooltip-text"])]))),256))])])])],64))}};var W=f(U,[["__scopeId","data-v-26ca8908"]]);function K(){const e=document.querySelector(".profile-ability-engrave");e.style.height="auto";const t=document.querySelectorAll(".swiper-slide>li"),a=[];t.length>0&&t.forEach(r=>{let s=JSON.parse(r.firstElementChild.innerHTML.replace(/(.+)\s(\d) ур\./g,'{"name":"$1", "level":$2}'));s.tooltipText=r.lastElementChild.firstElementChild.innerText,a.push(s)}),m(W,{engravingList:a}).mount(e)}let y={};function P(e){chrome.runtime.sendMessage({type:"load-for-class",message:[...new Set(e.map(t=>t.class))]},t=>{y=t,e.forEach(a=>{let r=X(a.class,a.name);r&&r>0&&(a.element.innerHTML=a.name+"("+r+")")})})}function X(e,t){var a;return y[e]?(a=y[e].find(r=>r.nickname===t))==null?void 0:a.rating:0}const Y={type:"button"},Z=["src","alt"],tt={__name:"CharacterList",props:{characterList:Array},setup(e){const t=e,a=h(()=>t.characterList.sort((r,s)=>+r.gs<+s.gs?1:+r.gs>+s.gs?-1:0));return(r,s)=>(i(!0),o(_,null,S(v(a),(l,p)=>(i(),o("li",{key:p+"ch"},[n("span",null,[n("button",Y,[n("img",{src:l.img,alt:l.characterClass},null,8,Z),k(" \u0423\u0440."+u(l.level)+" ",1),n("span",null,u(l.name)+"("+u(l.gs)+")",1)])])]))),128))}};function E(e){const t={};e.forEach(a=>{chrome.runtime.sendMessage({type:"load-character-info",name:a.name},r=>{t[a.name]=r.gs})}),setTimeout(()=>{const a=[];document.querySelectorAll("#expand-character-list > ul").forEach((s,l)=>{a.push([]),Array.from(s.children).forEach(p=>{const c={},b=p.querySelector("button span").textContent;c.name=b,c.gs=t[b],c.class=p.querySelector("button img").getAttribute("alt"),c.img=p.querySelector("button img").getAttribute("src"),c.level=60,a[l].push(c)}),m(tt,{characterList:a[l]}).mount(s)})},e.length*130)}const et={__name:"RefreshButton",props:{characterList:Array},setup(e){const t=e;function a(){E(t.characterList)}return(r,s)=>(i(),o("button",{onClick:a},"\u21BB"))}};let g={},d=[];async function at(){await chrome.storage.sync.get().then(e=>{Object.assign(g,N,e)})}try{document.querySelectorAll("#expand-character-list > ul > li").forEach(t=>{d.push({element:t.querySelector("span > button > span"),name:t.querySelector("button span").textContent,class:t.querySelector("button img").getAttribute("alt")})});const e=document.createElement("div");document.getElementById("expand-character-list").prepend(e),m(et,{characterList:d}).mount(e),at().then(()=>{g.loadAtStart?E(d):P(d),g.displayQuality&&Q(),g.modifyEngravings&&K()})}catch(e){console.error(e)}
